# copy and paste the following in your environment.

p = 110214139244619628817214220180759903623772273476973237581357926442068242777290742678308432173600447807045877802350820689329189906705525673103048044191741443155435676500083806328416857042655377621165517621594416756188456115632843630925048767223256580171880844584730175829519130860391756849271479689433096739183

F = GF(p)
g = F.multiplicative_generator()

pk = 34433677938790370326841544538327162949912651400435132418106303077870457237143764454742015325166343918042990360062245221128902045768722718013478894065082541995839757102391295145783918223456244521021455917802117759229766342977568038582505027961704596375794083965753629611033532591555874758736196549877539223439

def oracle(m):
    # this secret key is supposed to be SECRET!!!
    # this oracle is supposed to be a black box for you
    sk = 75634685477382510444330864520879772958994529678796910222627902736886490142385035840900624825784171137820168937351129077803696658896294516185852549440076452376282425274587541505371219507459795594844038021894626666390469834141313268358007359600087991446362848017047148793330467454171907456319139352116641008518

    log_p = ceil(log(p, 2))
    k = randint(0, log_p)
    while gcd(k, p-1) > 1:
        k = randint(0, log_p)

    one, k_inv, _ = xgcd(k, p-1)
    assert one == 1

    r = g ** k

    sig = ( k_inv * (m - sk  * ZZ(r)) ) % (p -1)
    return r, sig
